# プログラミングI 第9回
文字列処理と分岐制御

## 前回の課題

映画の視聴記録から２段階のハッシュ表を作成するプログラムを以下の方法で作成してください

* eachメソッドを使う方法
* for文を使う方法

作成した表を使って、以下の映画のそれぞれについて

類似度が高い順に５つ取り出し、さらにその５つの中から類似度が0.4に満たないものは reject メソッドを使って除いた結果を表示してください

* 未来のミライ
* バタフライ・エフェクト
* グレイテストショーマン
* フォレストガンプ
* シェイプオブウォーター
* アオハライド

## メッセージのデータ

松岡修造のつぶやき

[]()


```ruby
message=[
"自分らしく生きられていないのか？
自分を出し切れていないのか？
噴水を見てみろよ。
噴水は、喜びも悲しみも、
楽しさも悔しさも、
すべてを一生懸命に出し切っている。
だから、あれほどキラキラと輝いているんだよ。
君も噴水になってみろよ。
一つの所に命を懸けて、
すべてを出し切ってみろ！
きっとキラッキラに輝けるぞ！
",
"高い壁にぶつかって、
「できない」「やめたい」なんて思っているのか？
でも、君の脳は「ＮＯ！」なんて言ってないはず。
むしろ、全力で君を信じ、応援してくれているんだ。
人間の脳は、困難な場面を乗り越えた時、
強い快感を覚え、その喜びで成長すると言われている。
脳は成長するため、喜ぶために壁にぶつかることを求めているんだよ。
君なら必ず、その壁を乗り越えられる！
君の脳も、僕も、そう信じているんだ。
",
"僕の大好きな富士山。
本当に美しいよね。
だけど、富士山も自分の力だけで美しくなったわけじゃない。
いつまでも美しくあってほしい、
輝いていてほしい。
そんなふうに自分を愛してくれる人たちの思いを、
富士山は全力で受け止め、
自分のパワーに変えてきた。
だから、あれほど美しい姿になったんだ。
君も、周りにいる人たちの思いを感じてみないか。
そうすればきっと、君も富士山になれるよ。
",
"ゾウはあれほど体が大きいのに、
器用に動かせるのは長い鼻だけ。
でも、ゾウはできないことを嘆くのではなく、
長い鼻だけでできることを一所懸命考え、
徹底的に磨き上げた。
本気で努力したいからこそ、食事や水浴び、
何でもできるようになったんだ。
今は気がつかなくても、
君にも必ず一つ、
君だけにしかできないことがあるんだ。
それが見つかったら、迷わずゾウになれ！
僕もなるよ、松岡修ゾウに。
そして、君を全力で応援する！
",
"頑張っているのに、誰もほめてくれない、
なんてクヨクヨ悩んでいるのか？
だったら、マツタケを見てみろよ。
マツタケは枯れ葉の陰に隠れて育つから、
普段は誰にも気づかれない。
それでも、雨や風に耐えながら、
ひとり静かに頑張っている。
だから、誰にも真似できないほどの味や香りをまとい、
たくさんの人から「おいしいね」ってほめられるんだ。
君も必ずなれるよ。
とびっきりおいしいマツタケに！
",
"君はいつも、本当に頑張っているよね。
でも、時には思い切って休むことも大切だよ。
君を照らしてくれる太陽だって、
四六時中、輝いているわけじゃない。
水平線の向こうに沈んだ後は、
ゆっくり体を休めて、力を備えている。
だからこそ、次の日の朝、
元気な姿で昇ってくることができるんだ。
ここ一番の場面で力を発揮するためにも、
時には「休む勇気」を持つことも大切なんだ。
",
"いろんな絵の具を混ぜ合わせると、最後は黒になる。
同じにように、心の中でいろんな感情が混ざり合うと、
心はどんどん黒に近づいていく。
そんな時、僕は心の中にある洗濯機を回すんだ。
スイッチを入れ、グルグルと感情が回り始めると、
次第にイヤな気持ちが洗い流されて、
最後は真っ白でキレイな気持ちだけが残る。
何かに悩んでいるのなら、心の洗濯機を回すんだ！
",
"仕事、家事、勉強、スポーツ、習い事・・・、
何でも「基本」が大切だと言われているよね。
僕は基本を学び、
それを積み重ねていけば、
必ず本気になれると信じている。
信じられない？
それなら、基本って１０回言ってごらん。
キホンキホンキホンキホンキホン
キホンキホンキホンキホンキホンキ。
ほら、基本を積み重ねていけば、
本気になれるんだ。
そして、その経験はいつか必ず、
君を助ける力になってくれるよ。
",
"温泉に入ると、心も体も癒されて、
笑顔になれるよね。
でも、温泉が「俺を癒してくれ！」なんて、
見返りを求めてきたことあるかな？
僕たちは人に何かをした時、
つい見返りを求めてしまう。
与えた以上の見返りを期待することもある。
本当のやさしさって、
温泉のようなものじゃないかな。
ただ、相手が笑顔になってくれること。
それが最高の見返りだと思うんだ。
",
"山々を染める紅葉を見て、
「私もあんなふうに美しく輝きたい」
なんて思っていないか？
自然の紅葉は一年に一度しか輝かない。
でも、僕の心は春夏秋冬、常に紅葉している。
なぜなら、ポジティブな言葉で自分を前向きにしているから。
失敗を恐れず、何かにチャレンジしているから。
そうすると、
心が高揚して、美しく輝けるんだ。
大丈夫、君も心もきっと紅葉できる。
",
"最近、自我が強くなっていないか？
雪ダルマは、吹雪の中でも身動きひとつとれない。
春が来れば、いやおうなしに溶かされてしまう。
そんな雪ダルマが、文句を言ったことがあるか？
自己中心的な雪ダルマ、見たことがあるか？
誰かを楽しませるために、
自我を捨て、じっとたたずんでいるだろ。
だから、光輝いているんだよ。
時には自我を捨て、雪ダルマになることも大切なんだ。
",
"何となく周りに流されてしまう自分がイヤで、ネチネチ悩んでいるのか？
サバを見てみろよ。
いろいろな魚が泳いでいる所でも、周りを気にせず、常にサバサバしているだろ。
サバは「自分」を持っている。
常に自分の心に耳を傾け、自分で考え決断し、行動しているんだよ。
自分を持つことができれば、周りの声や視線など気にならず、
いつも自分らしくいられるんだ。
"
]
```


■文字列

●文字列のインデックス

p "しかもかもしかもしかである"[0]
p "しかもかもしかもしかである"[1]
p "しかもかもしかもしかである"[2]
p "しかもかもしかもしかである"[3]

●インデックスによる文字列要素への代入

message="しかもかもしかもしかである"
message[2]="と"
p message

●文字列の文字数を得るメソッド

"しかもかもしかもしかである".size


●文字列の部分を範囲で取り出す

"しかもかもしかもしかである"[3..6]

■正規表現
●正規表現と文字列の一致

p /しか/ =~ "しかもかもしかもしかである"
p /かもしか/ =~ "しかもかもしかもしかである"
p /もしも/ =~ "しかもかもしかもしかである"

●文字列の部分を全て置き換えるメソッド

p "しかもかもしかもしかである".gsub(/しか/,"鹿")

●文字列を置き換える順序による違い

message="しかしあしかはしかでない"
message=message.gsub(/しか/,"鹿")
message=message.gsub(/あしか/,"アシカ")
message=message.gsub(/しかし/,"然し")
puts message

message="しかしあしかはしかでない"
message=message.gsub(/あしか/,"アシカ")
message=message.gsub(/しかし/,"然し")
message=message.gsub(/しか/,"鹿")
puts message

■課題

●"しかもかもしかもしかであるしかしあしかはしかでない"
を
"鹿もカモシカも鹿である然しアシカは鹿でない"
に変換するプログラムを書いてください

●実際に実行した結果もコピーして付けてください



■前回の課題

message="しかもかもしかもしかであるしかしあしかはしかでない"
message=message.gsub(/あしか/,"アシカ") 
message=message.gsub(/かもしか/,"カモシカ") 
message=message.gsub(/しかし/,"然し") 
message=message.gsub(/しか/,"鹿") 
puts message

鹿もカモシカも鹿である然しアシカは鹿でない

●連結：+

p "わたし"+"まけましたわ"

●反転：reverse

p "abcdefg".reverse

●同一の文字列を比較：==

p "abc" == "abc"
p "abc" == "acb"

●空文字列か？：empty?

p "abc".empty?
p "".empty?

●文字列を整数に変換：to_i

p "20".to_i(10)
p "20"+"18"
p "20".to_i(10)+18

●分割：split

"九州工業大学九州大学福岡大学北九州市立大学福岡県立大学".split(/大学/)


■正規表現

●文字列の繰り返し

p /Goo*gl/=~"Gogl"
p /Goo*gl/=~"Googl"
p /Goo*gl/=~"Gooooooogl"

p /Goo+gl/=~"Gogl"
p /Goo+gl/=~"Googl"
p /Goo+gl/=~"Gooooooogl"

p /Goo?gl/=~"Gogl"
p /Goo?gl/=~"Googl"
p /Goo?gl/=~"Gooogl"

●任意の１文字とマッチする

p /私は.です/=~"私は神です"
p /私は.です/=~"私は人間です"
p /私は..です/=~"私は人間です"
p /私は.+です/=~"私はホモ・サピエンスです"

●[]の中のどれか１文字とマッチする

p /私は[鰻肉鮨]を食べたい/=~"私は鰻を食べたい"
p /私は[鰻肉鮨]を食べたい/=~"私は肉を食べたい"
p /私は[鰻肉鮨]を食べたい/=~"私は鮨を食べたい"
p /私は[鰻肉鮨]を食べたい/=~"私は米を食べたい"

●| で区切られたどれかの文字列とマッチする

p /私は(ステーキ|寿司)を食べたい/=~"私はステーキを食べたい"
p /私は(ステーキ|寿司)を食べたい/=~"私は寿司を食べたい"
p /私は(ステーキ|寿司)を食べたい/=~"私はいくらを食べたい"

●^	文字列の先頭のときだけマッチする

p /^カモシカ/ =~ "鹿もカモシカも鹿である"
p /^カモシカ/ =~ "カモシカは鹿である"

●$ 文字列の最後のときだけマッチする

p /ですか$/ =~ "あなたは大学教授ですか"
p /ですか$/ =~ "ああ大学教授ですか、ご愁傷さまです"

●メタ文字のエスケープ

p /www.kindai.ac.jp/=~"http://www=kindai-ac+jp"
p /www\.kindai\.ac\.jp/=~"http://www=kindai-ac+jp"
p /www\.kindai\.ac\.jp/=~"http://www.kindai.ac.jp"

●松岡修造ボット

def shuzo(msg)
  if /(どうしても|何度やっても|なかなか)/ =~ msg 
  then
    puts "今日からお前は、富士山だ！"
    puts "富士山みたいに日本一になるんだ！"
  end
  if /(悩んで|難し|挫折しそう|わからない|苦手)/ =~ msg 
  then
    puts "今日から君は噴水だ!!"
    puts "噴水を見てみろよ。噴水は、喜びも悲しみも、楽しさも悔しさも、すべてを一所懸命出し切っている。"
    puts "だから、あれほどキラキラと輝いているんだよ"
    puts "君も噴水になってみろ。"
  end
end

shuzo("どうしてもプログラミングがうまくなりません")
shuzo("プログラミングに挫折しそうです")

■課題
正規表現によるパターンマッチを利用して、できるだけ自然な会話をする美輪明宏ボットのプログラムを作成してください

例
miwasan("私のオーラは何色ですか")
=> あなたのオーラの色は紫ね

miwasan("私の前世は何ですか")
=> あなたの前世はピカチューね

miwasan("どうしてわかるんですか")
=> 見えるのよ



