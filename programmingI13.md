# プログラミングI 第13回

入力と出力、ライブラリの利用、ネットワークの利用

## 前回の課題

映画視聴履歴のCSVデータを利用

* CSV形式のファイルを csv ライブラリを使ってreadして、配列の配列に変換してください
* 数値部分を文字列から整数に変換してください
* 個人ごとの視聴履歴の配列を利用して
* 人と人とのtanimoto係数を、２段階ハッシュ表にしてください
* 最初の配列要素（映画名の一覧）は無視してください
* person_id というカラムを人のIDとして利用してください
(配列のインデックスを人のIDとして利用してください)

### 課題への方針

#### 当初の課題の場合

* 配列のインデックスを人のIDにする方法の例
* 各配列の最初の要素としてインデックスを入れる

```ruby
# テストデータ 4個の配列の配列
test=[[0,1,1,0,0,0],[0,0,1,0,1,0],[0,0,1,0,0,1],[0,1,1,0,1,1]]
```

に対して、以下のようにインデックス0に配列のインデックスが入るようにすればよい

```ruby
# テストデータ 4個の配列の配列
data=[[0,0,1,1,0,0,0],[1,0,0,1,0,1,0],[2,0,0,1,0,0,1],[3,0,1,1,0,1,1]]
```

* プログラムの例（for文を使った例）

```ruby
data=[]
for i in (0..3) do
  data[i]=[i]+test[i]
end
p data
```

実行結果

```ruby
[[0, 0, 1, 1, 0, 0, 0], [1, 0, 0, 1, 0, 1, 0], [2, 0, 0, 1, 0, 0, 1], [3, 0, 1, 1, 0, 1, 1]]
```

### 修正版の課題へのアプローチ

* CSVファイルを読み込む
* 数値の文字列を整数に変換する
* 映画名など余分な要素を取り除く
* 人に関するtanimoto係数の表を２段ハッシュとして作成する


```ruby
require 'csv'
d=CSV.read('File3','r')
d2=d[1..-1]
data=d2.map do |x|
        x.map do |y|
            if /\d+/=~y then	 # 数値の文字列の場合
                y.to_i         # 文字列を整数に変換
            else
                y
            end
        end
    end
p data
```



## 課題

映画視聴履歴のCSVデータを利用

* CSV形式のファイルを csv ライブラリを使ってreadして、配列の配列に変換してください
* 数値部分を文字列から整数に変換してください
* 個人ごとの視聴履歴の配列を利用して
* 人と人とのtanimoto係数を、２段階ハッシュ表にしてください
* 最初の配列要素（映画名の一覧）は無視してください
* person_id というカラムを人のIDとして利用してください


3